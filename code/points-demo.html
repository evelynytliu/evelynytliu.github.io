<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-WX5VQK2V');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" />
    <title>Points & Screen Time (Demo Version)</title>

    <link href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-dark@4/dark.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --primary: #00d4ff;
            --primary-hover: #00b8dd;
            --bg-dark: #111;
            --bg-card: #1c1c3c;
            --bg-input: #222;
            --text-main: #eee;
            --text-muted: #bbb;
            --radius-lg: 20px;
            --shadow-glow: 0 4px 15px rgba(0, 212, 255, 0.3);
        }

        body {
            font-family: 'Poppins', system-ui, -apple-system, 'Noto Sans TC', sans-serif;
            background: var(--bg-dark);
            color: var(--text-main);
            text-align: center;
            padding: 20px 10px;
            margin: 0;
            -webkit-tap-highlight-color: transparent;
        }

        h1 {
            margin: 10px 0 5px;
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 14px;
            color: #888;
            margin-bottom: 20px;
        }

        /* --- å¡ç‰‡æ¨£å¼ --- */
        .child-card {
            background: var(--bg-card);
            padding: 24px;
            margin: 18px auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-glow);
            max-width: 440px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .child-name {
            font-size: 26px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 12px;
        }

        .points-box {
            background: rgba(0, 0, 0, 0.3);
            padding: 16px;
            border-radius: 16px;
            font-size: 36px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 12px;
            border: 1px solid rgba(0, 212, 255, 0.1);
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.4);
        }

        .conversion-info {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: 6px;
            font-weight: normal;
        }

        /* --- é€²åº¦æ¢å€å¡Š --- */
        .progress-dual {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin-bottom: 10px;
        }

        .progress-title {
            font-size: 14px;
            color: var(--primary);
            margin: 6px 0 4px;
            display: flex;
            justify-content: space-between;
            padding: 0 8px;
        }

        .bar-wrap {
            background: #222;
            border: 2px solid rgba(0, 212, 255, 0.3);
            border-radius: 30px;
            overflow: hidden;
            height: 36px;
            width: 100%;
            position: relative;
        }

        .fill {
            height: 100%;
            width: 0%;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(90deg, var(--primary), #005eff);
            box-shadow: 0 0 10px var(--primary);
        }

        .fill.warning {
            background: linear-gradient(90deg, #ffaa00, #ff7700);
            box-shadow: 0 0 10px #ffaa00;
        }

        .fill.danger {
            background: linear-gradient(90deg, #ff4444, #ff0000);
            box-shadow: 0 0 10px #ff0000;
        }

        .bar-text {
            position: absolute;
            width: 100%;
            text-align: center;
            top: 0;
            line-height: 36px;
            font-weight: 700;
            color: #fff;
            font-size: 15px;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8);
            z-index: 2;
            pointer-events: none;
        }

        /* --- æŒ‰éˆ•èˆ‡æ§åˆ¶å€ --- */
        .control-row {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
            margin: 16px 0;
        }

        .control-row .right {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .deduct-btn {
            padding: 10px 0;
            font-size: 15px;
            border-radius: 12px;
            border: none;
            background: #333;
            color: #ccc;
            cursor: pointer;
            transition: 0.2s;
        }

        .deduct-btn:active {
            background: #555;
            transform: scale(0.95);
        }

        .chip-toggle {
            background: #222;
            border-radius: 999px;
            padding: 4px;
            display: inline-flex;
            gap: 4px;
            justify-content: center;
            margin-bottom: 8px;
        }

        .chip-toggle button {
            border: none;
            padding: 8px 16px;
            border-radius: 999px;
            background: transparent;
            color: #888;
            cursor: pointer;
            font-weight: 600;
            transition: 0.3s;
        }

        .chip-toggle button.active {
            background: var(--primary);
            color: #111;
            box-shadow: 0 2px 8px rgba(0, 212, 255, 0.4);
        }

        .convert-group {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 8px;
        }

        .btn {
            padding: 10px 16px;
            font-size: 15px;
            border: none;
            border-radius: 12px;
            width: 100%;
            color: #eee;
            font-weight: 700;
            cursor: pointer;
            background: #444;
            transition: 0.2s;
        }

        .btn:hover {
            background: #555;
        }

        .btn.primary {
            background: var(--primary);
            color: #111;
        }

        .btn:active {
            transform: scale(0.96);
        }

        /* --- è¡¨å–®å€ --- */
        #form-section {
            background: #2a2a5a;
            padding: 24px 20px;
            border-radius: 24px;
            max-width: 440px;
            margin: 24px auto 60px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        input[type="number"],
        input[type="text"],
        button.submit-btn {
            padding: 12px;
            margin: 8px 0;
            font-size: 16px;
            border-radius: 10px;
            border: none;
            width: 100%;
            box-sizing: border-box;
        }

        input {
            background: rgba(0, 0, 0, 0.3);
            color: #fff;
            border: 1px solid #444;
            text-align: center;
        }

        input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .submit-btn {
            background: var(--primary);
            color: #111;
            font-weight: 800;
            margin-top: 12px;
            box-shadow: 0 4px 12px rgba(0, 212, 255, 0.4);
            cursor: pointer;
        }

        .submit-btn:active {
            transform: scale(0.98);
        }

        /* æ–¹æ¡ˆåˆ‡æ› */
        .plan-toggle {
            background: #222;
            border-radius: 999px;
            padding: 4px;
            display: inline-flex;
            gap: 4px;
            margin-top: 10px;
        }

        .btn-plan {
            border: none;
            padding: 8px 20px;
            border-radius: 999px;
            background: transparent;
            color: #888;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
        }

        .btn-plan.active {
            background: var(--primary);
            color: #111;
        }

        /* --- Checkbox Group --- */
        .checkbox-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 15px;
        }

        .checkbox-group input {
            display: none;
        }

        .checkbox-group label {
            display: block;
            padding: 14px;
            background: #333;
            color: #ccc;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            user-select: none;
            transition: 0.2s;
            border: 2px solid transparent;
        }

        .checkbox-group input:checked+label {
            background: rgba(0, 212, 255, 0.1);
            color: var(--primary);
            border-color: var(--primary);
            font-weight: bold;
        }

        /* Name Item Wrapper */
        .kid-check-wrapper {
            position: relative;
        }

        .kid-check-wrapper button.edit-icon {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.4);
            border: none;
            color: #666;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: 0.2s;
        }

        .kid-check-wrapper button.edit-icon:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
        }

        /* Add Name Area */
        .add-name-area {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .add-name-area input {
            margin: 0;
            text-align: left;
        }

        .add-name-area button {
            width: 50px;
            background: #444;
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
        }

        .add-name-area button:hover {
            background: #555;
        }

        .pair {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .note {
            font-size: 12px;
            color: #888;
            margin-top: 12px;
            line-height: 1.6;
        }

        .preview {
            margin-top: 8px;
            font-size: 13px;
            color: #9ecfff;
        }

        /* Demo æç¤º */
        .demo-alert {
            background: rgba(255, 200, 0, 0.15);
            color: #ffca28;
            font-size: 13px;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255, 200, 0, 0.3);
            max-width: 440px;
            margin: 0 auto 20px;
            text-align: left;
        }

        .demo-alert strong {
            color: #fff;
        }

        /* SweetAlert è‡ªå®šç¾©æ¨£å¼ */
        .swal2-popup {
            border-radius: 20px !important;
            background: #222 !important;
            border: 1px solid #444;
        }

        .swal2-title {
            color: #fff !important;
        }

        .swal2-content {
            color: #ccc !important;
        }
    </style>
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WX5VQK2V" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <h1>â­ Points & Screen Time ğŸ“º</h1>
    <div class="subtitle">Live Demo / Local Storage Version</div>

    <div class="demo-alert">
        <strong>ğŸ’¡ é€™æ˜¯é«”é©—ç‰ˆæœ¬ (Local Demo)</strong><br>
        æ‰€æœ‰æ“ä½œåªæœƒå„²å­˜åœ¨æ‚¨çš„ç€è¦½å™¨ä¸­ï¼Œä¸æœƒä¸Šå‚³åˆ°ä»»ä½•ä¼ºæœå™¨ã€‚æ‚¨å¯ä»¥è‡ªç”±æ¸¬è©¦åŠ åˆ†ã€æ‰£åˆ†èˆ‡å…Œæ›åŠŸèƒ½ï¼
    </div>

    <div id="leaderboard"></div>

    <div id="form-section">
        <h2 style="margin-top:0;color:#fff;">ç®¡ç†å¾Œå° ğŸ“</h2>

        <div id="name-list" class="checkbox-group"></div>

        <!-- æ–°å¢åå­—å€å¡Š -->
        <div class="add-name-area">
            <input type="text" id="newKidName" placeholder="+ æ–°å¢åå­—..."
                style="background:rgba(255,255,255,0.1);border:1px dashed #666;">
            <button onclick="addNewKid()">ï¼‹</button>
        </div>

        <div class="plan-toggle">
            <button type="button" id="alloc-weekday" class="btn-plan active"
                onclick="setAllocPlan('weekday')">å¹³æ—¥</button>
            <button type="button" id="alloc-holiday" class="btn-plan" onclick="setAllocPlan('holiday')">å‡æ—¥</button>
        </div>
        <div id="alloc-preview" class="preview">â€”</div>

        <input type="number" id="pointsChange" placeholder="â­ é»æ•¸èª¿æ•´ (è¼¸å…¥æ­£æ•¸à¸¡à¸µç‰¹æ•ˆ)">
        <input type="number" id="screenTimeChange" placeholder="ğŸ“º è¢å¹•æ™‚é–“å¢æ¸›">
        <input type="text" id="reason" placeholder="åŸå›  (é¸å¡«)">

        <button type="button" class="submit-btn" onclick="submitData()">åŸ·è¡Œæ›´æ–° ğŸš€</button>

        <div class="note">
            è¦å‰‡ï¼šâ­1é» â‡„ ğŸ“º2åˆ†é˜<br>
            <a href="#" onclick="resetDemoData();return false;" style="color:#666;text-decoration:underline;">é‡ç½®æ‰€æœ‰æ•¸æ“š</a>
        </div>
    </div>

    <div style="margin-top:40px;font-size:12px;color:#555;">
        Template by Evelyn YT | Demo Version | <a href="points-intro.html" style="color:#777;">å–å¾—åŸå§‹ç¢¼ & è·¨è£ç½®è¨­å®š</a>
    </div>

    <script>
        // ==========================================
        // âš™ï¸ è¨­å®šå€ (å¯ä»¥è®“ä½¿ç”¨è€…è‡ªå·±ä¿®æ”¹)
        // ==========================================
        const CONFIG = {
            // å°å­©åå–®èˆ‡åˆå§‹å€¼
            DEFAULT_KIDS: [
                { Name: 'Mario', TotalPoints: 10, TotalMinutes: 45 },
                { Name: 'Luigi', TotalPoints: 5, TotalMinutes: 15 },
                { Name: 'Peach', TotalPoints: 25, TotalMinutes: 30 }
            ],
            // æ–¹æ¡ˆä¸Šé™
            LIMITS: { weekday: 50, holiday: 90 },
            // LocalStorage Key
            STORAGE_KEY: 'screenTime_demo_v2'
        };
        // ==========================================

        let currentData = [];
        let allocPlan = 'weekday';

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            syncAllocPlanButtons();
            updateAllocPreview();
        });

        // --- è³‡æ–™è™•ç†æ ¸å¿ƒ (Local Logic) ---

        function loadData() {
            const saved = localStorage.getItem(CONFIG.STORAGE_KEY);
            if (saved) {
                currentData = JSON.parse(saved);
            } else {
                currentData = JSON.parse(JSON.stringify(CONFIG.DEFAULT_KIDS));
                saveData();
            }
            renderLeaderboard();
        }

        function saveData() {
            localStorage.setItem(CONFIG.STORAGE_KEY, JSON.stringify(currentData));
            renderLeaderboard();
        }

        function resetDemoData() {
            Swal.fire({
                title: 'é‡ç½®è³‡æ–™?',
                text: "å°‡æ¢å¾©åˆ°é è¨­ç‹€æ…‹",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                background: '#333', color: '#fff'
            }).then((result) => {
                if (result.isConfirmed) {
                    localStorage.removeItem(CONFIG.STORAGE_KEY);
                    loadData();
                    Swal.fire({ icon: 'success', title: 'å·²é‡ç½®', timer: 1000, showConfirmButton: false, background: '#333', color: '#fff' });
                }
            });
        }

        // --- UI æ¸²æŸ“ ---

        function renderLeaderboard() {
            const board = document.getElementById('leaderboard');
            const nameBox = document.getElementById('name-list');

            const oldChecks = new Set([...document.querySelectorAll('#name-list input:checked')].map(c => c.value));
            nameBox.innerHTML = '';

            let html = '';
            const maxTime = CONFIG.LIMITS[allocPlan];

            currentData.forEach(entry => {
                const cid = `chk-${entry.Name}`;
                const isChecked = oldChecks.has(entry.Name) ? 'checked' : '';
                nameBox.innerHTML += `
        <div class="kid-check-wrapper">
          <input type="checkbox" id="${cid}" value="${entry.Name}" ${isChecked}>
          <label for="${cid}">${entry.Name}</label>
          <button class="edit-icon" onclick="editKid('${entry.Name}'); event.preventDefault();">âœ</button>
        </div>
      `;

                const mins = entry.TotalMinutes || 0;
                const pts = entry.TotalPoints || 0;
                const pct = Math.min(100, (mins / maxTime) * 100);
                const barClass = pct <= 20 ? 'danger' : (pct <= 50 ? 'warning' : '');

                html += `
        <div class="child-card">
          <div class="child-name">${entry.Name}</div>

          <div class="points-box">
            â­ ${pts}
             <div class="conversion-info">
                å¯æ›ï¼šğŸ“º ${pts * 2}m <span style="margin:0 5px;color:#555">|</span> ğŸ’° $${pts * 5}
             </div>
          </div>

          <div class="progress-dual">
            <div>
              <div class="progress-title">
                <span>ğŸ“º è¢å¹•æ™‚é–“</span> <span style="font-size:12px;color:#666">ä¸Šé™: ${maxTime}m</span>
              </div>
              <div class="bar-wrap">
                <div class="fill ${barClass}" style="width:${pct}%"></div>
                <div class="bar-text">${mins}m</div>
              </div>
            </div>
          </div>

          <div class="control-row">
             <div class="right" style="width:100%; grid-template-columns: repeat(3, 1fr);">
                <button class="deduct-btn" onclick="quickDeduct('${entry.Name}', 10)">-10</button>
                <button class="deduct-btn" onclick="quickDeduct('${entry.Name}', 30)">-30</button>
                <button class="deduct-btn" style="color:#ff6666" onclick="customDeduct('${entry.Name}')">è‡ªè¨‚</button>
             </div>
          </div>

          <div class="convert-group">
            <button class="btn" onclick="convertTimeToPoints('${entry.Name}')">ğŸ“º â” â­</button>
            <button class="btn primary" onclick="convertPointsToTime('${entry.Name}')">â­ â” ğŸ“º</button>
          </div>
        </div>
        `;
            });

            board.innerHTML = html;
        }

        // --- è¡¨å–®èˆ‡è¨­å®šé‚è¼¯ ---

        function setAllocPlan(plan) {
            allocPlan = plan;
            syncAllocPlanButtons();
            updateAllocPreview(true);

            document.getElementById('screenTimeChange').value = CONFIG.LIMITS[plan];
            document.getElementById('reason').value = `${plan === 'weekday' ? 'å¹³æ—¥' : 'å‡æ—¥'}åˆ†é…`;

            renderLeaderboard();
        }

        function syncAllocPlanButtons() {
            document.querySelectorAll('.btn-plan').forEach(b => b.classList.remove('active'));
            document.getElementById(allocPlan === 'weekday' ? 'alloc-weekday' : 'alloc-holiday').classList.add('active');
        }

        function updateAllocPreview(bump) {
            const el = document.getElementById('alloc-preview');
            const lim = CONFIG.LIMITS[allocPlan];
            el.textContent = `ç•¶å‰ï¼š${allocPlan === 'weekday' ? 'å¹³æ—¥' : 'å‡æ—¥'} (ä¸Šé™ ${lim}m) `;
            if (bump) {
                el.style.transform = 'scale(1.1)';
                el.style.transition = '0.2s';
                setTimeout(() => el.style.transform = 'scale(1)', 200);
            }
        }

        // --- è³‡æ–™æ“ä½œ (Actions) ---

        function submitData() {
            const checked = [...document.querySelectorAll('#name-list input:checked')];
            if (checked.length === 0) return Swal.fire({ icon: 'warning', title: 'è«‹é¸æ“‡å°è±¡', background: '#333', color: '#fff' });

            const pts = parseInt(document.getElementById('pointsChange').value) || 0;
            const timeChange = parseInt(document.getElementById('screenTimeChange').value) || 0;

            if (pts === 0 && timeChange === 0) return Swal.fire({ icon: 'info', title: 'æ•¸å€¼æœªè®Šæ›´', background: '#333', color: '#fff' });

            if (pts > 0) {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#00d4ff', '#ff0', '#f0f'] });
            }

            checked.forEach(cb => {
                modifyKidData(cb.value, pts, timeChange);
            });

            document.getElementById('pointsChange').value = '';
            document.getElementById('screenTimeChange').value = '';
            document.getElementById('name-list').querySelectorAll('input').forEach(i => i.checked = false);

            Swal.fire({ icon: 'success', title: 'æ›´æ–°æˆåŠŸ', timer: 1000, showConfirmButton: false, background: '#333', color: '#fff' });
        }

        function quickDeduct(name, minutes) {
            const kid = currentData.find(k => k.Name === name);

            if (kid.TotalMinutes < minutes) return Swal.fire({ icon: 'error', title: 'æ™‚é–“ä¸è¶³', text: `ç›®å‰åªæœ‰ ${kid.TotalMinutes} åˆ†`, background: '#333', color: '#fff' });

            Swal.fire({
                title: `æ‰£é™¤ ${minutes} åˆ†?`,
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                confirmButtonText: 'æ‰£é™¤',
                background: '#333', color: '#fff'
            }).then((res) => {
                if (res.isConfirmed) {
                    modifyKidData(name, 0, -minutes);
                    Swal.fire({ icon: 'success', title: 'å·²æ‰£é™¤', timer: 1000, showConfirmButton: false, background: '#333', color: '#fff' });
                }
            });
        }

        function customDeduct(name) {
            Swal.fire({
                title: 'è¼¸å…¥æ‰£é™¤åˆ†é˜',
                input: 'number',
                background: '#333', color: '#fff',
                showCancelButton: true
            }).then(res => {
                if (res.isConfirmed && res.value) {
                    quickDeduct(name, parseInt(res.value));
                }
            });
        }

        function convertTimeToPoints(name) {
            const kid = currentData.find(k => k.Name === name);
            const mins = kid.TotalMinutes;
            const rate = 2; // 2 min = 1 pt
            const maxPts = Math.floor(mins / rate);

            if (maxPts < 1) return Swal.fire({ icon: 'info', title: 'æ™‚é–“ä¸è¶³', text: 'è‡³å°‘éœ€2åˆ†é˜', background: '#333', color: '#fff' });

            Swal.fire({
                title: 'ğŸ“º â” â­ è½‰æ›',
                text: `ç›®å‰: ${mins}åˆ† (æœ€å¤šæ› ${maxPts}é»)`,
                input: 'number',
                inputValue: 1,
                inputAttributes: { min: 1, max: maxPts },
                showCancelButton: true,
                background: '#333', color: '#fff'
            }).then((res) => {
                if (res.isConfirmed) {
                    const want = parseInt(res.value);
                    if (want > 0 && want <= maxPts) {
                        modifyKidData(name, want, -(want * rate));
                        confetti({ particleCount: 50, spread: 50, origin: { y: 0.7 } });
                        Swal.fire({ icon: 'success', title: `ç²å¾— ${want} é»!`, background: '#333', color: '#fff' });
                    }
                }
            });
        }

        function convertPointsToTime(name) {
            const kid = currentData.find(k => k.Name === name);
            const rate = 2; // 1 point = 2 mins

            if (kid.TotalPoints < 1) return Swal.fire({ icon: 'info', title: 'é»æ•¸ä¸è¶³', background: '#333', color: '#fff' });

            Swal.fire({
                title: 'â­ â” ğŸ“º å…Œæ›',
                text: `åŒ¯ç‡: 1é» = ${rate}åˆ†`,
                input: 'number',
                inputValue: 1,
                inputAttributes: { min: 1, max: kid.TotalPoints },
                showCancelButton: true,
                background: '#333', color: '#fff'
            }).then((res) => {
                if (res.isConfirmed) {
                    const want = parseInt(res.value);
                    if (want > 0 && want <= kid.TotalPoints) {
                        const mins = want * rate;
                        modifyKidData(name, -want, mins);
                        Swal.fire({ icon: 'success', title: `å¢åŠ  ${mins} åˆ†é˜!`, background: '#333', color: '#fff' });
                    }
                }
            });
        }

        function modifyKidData(name, dPoints, dMinutes) {
            const target = currentData.find(k => k.Name === name);
            if (target) {
                target.TotalPoints = Math.max(0, target.TotalPoints + dPoints);
                target.TotalMinutes = Math.max(0, target.TotalMinutes + dMinutes);
                saveData();
            }
        }

        // --- æ–°å¢ / ç·¨è¼¯ / åˆªé™¤ ---
        function addNewKid() {
            const input = document.getElementById('newKidName');
            const name = input.value.trim();
            if (!name) return;

            if (currentData.find(k => k.Name === name)) {
                return Swal.fire({ icon: 'error', title: 'åå­—å·²å­˜åœ¨', background: '#333', color: '#fff' });
            }

            currentData.push({ Name: name, TotalPoints: 0, TotalMinutes: 0 });
            saveData();
            input.value = '';
            Swal.fire({ icon: 'success', title: 'å·²æ–°å¢', timer: 1000, showConfirmButton: false, background: '#333', color: '#fff' });
        }

        function editKid(oldName) {
            Swal.fire({
                title: `ç·¨è¼¯ ${oldName}`,
                input: 'text',
                inputValue: oldName,
                showDenyButton: true,
                denyButtonText: 'åˆªé™¤',
                denyButtonColor: '#d33',
                confirmButtonText: 'æ›´å',
                showCancelButton: true,
                background: '#333', color: '#fff'
            }).then((res) => {
                if (res.isConfirmed) {
                    const newName = res.value.trim();
                    if (newName && newName !== oldName) {
                        if (currentData.find(k => k.Name === newName)) {
                            return Swal.fire({ icon: 'error', title: 'åå­—å·²å­˜åœ¨', background: '#333', color: '#fff' });
                        }
                        const kid = currentData.find(k => k.Name === oldName);
                        kid.Name = newName;
                        saveData();
                    }
                } else if (res.isDenied) {
                    Swal.fire({
                        title: `ç¢ºå®šåˆªé™¤ ${oldName}?`,
                        text: 'åˆªé™¤å¾Œç„¡æ³•å¾©åŸ',
                        icon: 'warning',
                        showCancelButton: true,
                        confirmButtonColor: '#d33',
                        background: '#333', color: '#fff'
                    }).then(delRes => {
                        if (delRes.isConfirmed) {
                            currentData = currentData.filter(k => k.Name !== oldName);
                            saveData();
                        }
                    });
                }
            });
        }
    </script>
</body>

</html>