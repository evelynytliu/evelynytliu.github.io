<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ…§éƒµä»¶åˆ†ç™¼å™¨ Smart Email Dispatcher | Google Apps Script è‡ªå‹•åŒ–å·¥å…·</title>
    <meta name="description" content="ä¸€å€‹å…è²»ã€é–‹æºçš„ Gmail è‡ªå‹•åˆ†æµç³»çµ±ã€‚é€é Google Apps Script è‡ªå‹•å°‡è©¢åƒ¹èˆ‡å®¢æˆ¶ä¿¡ä»¶è½‰å¯„çµ¦å°æ‡‰éƒ¨é–€ï¼Œä¸¦ç™¼é€æ¯æ—¥èˆ‡æ¯é€±æ‘˜è¦å ±å‘Šã€‚">
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --bg-color: #f8fafc;
            --text-color: #334155;
            --card-bg: #ffffff;
            --border-radius: 12px;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 50px;
        }

        h1 {
            font-size: 2.5rem;
            color: #1e293b;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: #64748b;
        }

        /* Feature Cards */
        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .feature-card {
            background: var(--card-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: transform 0.2s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-icon {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        /* Code Section */
        .code-section {
            background: #1e1e1e; /* Match prism tomorrow theme */
            border-radius: var(--border-radius);
            position: relative;
            margin-bottom: 50px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #2d2d2d;
            border-bottom: 1px solid #404040;
        }

        .code-title {
            color: #e5e7eb;
            font-family: monospace;
            font-weight: bold;
        }

        .copy-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
        }

        .copy-btn:hover {
            background-color: var(--secondary-color);
        }

        .copy-btn.copied {
            background-color: #10b981;
        }

        pre {
            margin: 0 !important;
            padding: 20px !important;
            max-height: 600px;
            overflow-y: auto;
        }

        /* Guide Section */
        .guide-section {
            background: var(--card-bg);
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .step {
            margin-bottom: 30px;
            padding-left: 20px;
            border-left: 4px solid var(--primary-color);
        }

        .step h3 {
            margin-top: 0;
            color: #1e293b;
        }

        /* Footer */
        footer {
            margin-top: 60px;
            text-align: center;
            padding: 40px 20px;
            border-top: 1px solid #e2e8f0;
            color: #64748b;
            font-size: 0.9rem;
        }

        footer a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        footer a:hover {
            color: var(--secondary-color);
            text-decoration: underline;
        }
        
        .footer-logo {
             margin-bottom: 15px;
             font-weight: bold;
             font-size: 1.1em;
             color: #333;
        }

        @media (max-width: 600px) {
            h1 { font-size: 1.8rem; }
            .container { padding: 20px; }
            .guide-section { padding: 20px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1><i class="fa-solid fa-robot"></i> æ™ºæ…§éƒµä»¶åˆ†ç™¼å™¨</h1>
            <p class="subtitle">Smart Email Dispatcher (Google Apps Script)</p>
            <p>ä¸€å€‹è¼•é‡ç´šã€å®Œå…¨å…è²»çš„ Gmail è‡ªå‹•åŒ–æ–¹æ¡ˆã€‚<br>è‡ªå‹•å°‡è©¢åƒ¹ä¿¡ä»¶è½‰å¯„çµ¦å°æ‡‰éƒ¨é–€ï¼Œä¸¦ç™¼é€æ¯æ—¥èˆ‡æ¯é€±æ‘˜è¦å ±å‘Šã€‚</p>
        </header>

        <section class="features">
            <div class="feature-card">
                <div class="feature-icon"><i class="fa-solid fa-filter"></i></div>
                <h3>é—œéµå­—åˆ†æµ</h3>
                <p>è¨­å®šé—œéµå­—ï¼ˆå¦‚ï¼šè©¢åƒ¹ã€åˆä½œã€å ±ä¿®ï¼‰ï¼Œç³»çµ±è‡ªå‹•å°‡ä¿¡ä»¶è½‰å¯„çµ¦è² è²¬çš„æ¥­å‹™æˆ–å®¢æœã€‚</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fa-solid fa-chart-line"></i></div>
                <h3>å®šæœŸå ±è¡¨ (æ—¥/é€±)</h3>
                <p>æ¯æ—¥å¯„é€æ‘˜è¦çµ¦åŸ·è¡Œè€…ï¼Œæ¯é€±å¯„é€ç¸½çµå ±å‘Šçµ¦ä¸»ç®¡ï¼Œç¢ºä¿è³‡è¨ŠåŒæ­¥ä¸æ¼æ¥ã€‚</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fa-solid fa-user-shield"></i></div>
                <h3>éš±ç§èˆ‡å®‰å…¨</h3>
                <p>ç¨‹å¼ç¢¼åœ¨æ‚¨è‡ªå·±çš„ Google å¸³è™Ÿä¸‹é‹è¡Œï¼Œè³‡æ–™ä¸ç¶“éç¬¬ä¸‰æ–¹ä¼ºæœå™¨ï¼Œå®‰å…¨ç„¡è™ã€‚</p>
            </div>
        </section>

        <section class="code-section">
            <div class="code-header">
                <span class="code-title">Code.gs</span>
                <button class="copy-btn" onclick="copyCode()">
                    <i class="fa-regular fa-copy"></i> è¤‡è£½ç¨‹å¼ç¢¼
                </button>
            </div>
            <pre><code class="language-javascript" id="script-code">/**
 * ------------------------------------------------------------------
 * ğŸ› ï¸ è¨­å®šå€åŸŸ (USER CONFIGURATION)
 * è«‹åœ¨æ­¤è™•ä¿®æ”¹æ‚¨çš„è¨­å®šï¼Œç„¡é ˆæ›´å‹•ä¸‹æ–¹æ ¸å¿ƒç¨‹å¼ç¢¼ã€‚
 * ------------------------------------------------------------------
 */
const USER_CONFIG = {
  // 1. å ±å‘Šæ¥æ”¶è¨­å®š
  // æ¯æ—¥å ±å‘Šæ¥æ”¶è€… (é€šå¸¸æ˜¯è² è²¬æ“ä½œçš„äºº)
  DAILY_REPORT_EMAIL: "admin@yourdomain.com",
  
  // é€±å ±æ¥æ”¶è€… (å¯ä»¥æ˜¯å¤šå€‹ä¿¡ç®±ï¼Œç”¨é€—è™Ÿéš”é–‹ï¼Œä¾‹å¦‚ä¸»ç®¡æˆ–åœ˜éšŠç¾¤çµ„)
  WEEKLY_REPORT_RECIPIENTS: "admin@yourdomain.com, manager@yourdomain.com",
  
  // å¯„ä»¶é¡¯ç¤ºåç¨±
  SENDER_NAME: "Email Bot",

  // 2. åœ˜éšŠåˆ†æµè¦å‰‡ (æ ¼å¼ï¼š "æ¥æ”¶ä¿¡ç®±": ["é—œéµå­—1", "é—œéµå­—2"...])
  // ç¨‹å¼æœƒæƒæéƒµä»¶çš„ä¸»æ—¨èˆ‡å…§æ–‡ï¼Œè‹¥ç¬¦åˆé—œéµå­—ï¼Œå³è½‰å¯„çµ¦è©²ä¿¡ç®±ã€‚
  ROUTING_RULES: {
    "sales@yourdomain.com": [
      "inquiry", "quote", "price", "rfq", "order", "purchase", "buying", 
      "å ±åƒ¹", "è©¢åƒ¹", "æ¡è³¼", "è¨‚è³¼", "è²»ç”¨"
    ],
    "support@yourdomain.com": [
      "help", "issue", "bug", "error", "problem", "fail", "support", 
      "å•é¡Œ", "éŒ¯èª¤", "æ”¯æ´", "ç„¡æ³•ä½¿ç”¨", "æ•…éšœ"
    ],
    "marketing@yourdomain.com": [
      "collab", "partnership", "media", "press", "sponsor", 
      "åˆä½œ", "åª’é«”", "è¡ŒéŠ·", "è´ŠåŠ©", "å»£å‘Š"
    ]
  },

  // 3. ä¸€èˆ¬è©¢åƒ¹è­˜åˆ¥é—œéµå­— (ç”¨æ–¼åˆæ­¥ç¯©é¸æ˜¯å¦ç‚ºé‡è¦éƒµä»¶)
  // è‹¥ä¿¡ä»¶åŒ…å«é€™äº›å­—ï¼Œä½†æ²’å°æ‡‰åˆ°ä¸Šæ–¹è¦å‰‡ï¼Œæœƒè¢«æ¨™è¨˜ç‚ºã€ŒæœªçŸ¥è©¢åƒ¹ã€ä¸¦å¯„çµ¦ç®¡ç†å“¡
  GENERAL_KEYWORDS: [
    "interested in", "looking for", "catalogue", "demo", 
    "æœ‰èˆˆè¶£", "ç”¢å“ç›®éŒ„", "éœ€æ±‚", "è«‹æ•™"
  ],

  // 4. æ’é™¤è¨­å®š (é»‘åå–®)
  // è‹¥ä¸»æ—¨æˆ–å¯„ä»¶äººåŒ…å«é€™äº›å­—ï¼Œå°‡ç›´æ¥å¿½ç•¥ä¸è™•ç†
  EXCLUDE_KEYWORDS: [
    "unsubscribe", "newsletter", "promotion", "no-reply", "noreply", 
    "å–æ¶ˆè¨‚é–±", "é›»å­å ±", "å»£å‘Š", "ç³»çµ±é€šçŸ¥", "é©—è­‰ç¢¼", "å¸³å–®"
  ],

  // 5. æ¨™ç±¤è¨­å®š (æœƒåœ¨ Gmail ä¸­è‡ªå‹•å»ºç«‹)
  LABEL_PREFIX: "ğŸ¤– è‡ªå‹•åˆ†æµ - ",
  UNKNOWN_LABEL: "âš ï¸ æœªåˆ†é¡è©¢åƒ¹"
};

/**
 * ------------------------------------------------------------------
 * ğŸš€ æ ¸å¿ƒç¨‹å¼ç¢¼å€åŸŸ (CORE LOGIC)
 * é€šå¸¸ä¸éœ€è¦ä¿®æ”¹ä»¥ä¸‹å…§å®¹
 * ------------------------------------------------------------------
 */

// ğŸ“Œ å…±ç”¨å·¥å…·å‡½å¼
function formatDate(date) {
  if (!date || !(date instanceof Date)) return "Invalid Date";
  const year = date.getFullYear();
  const month = ('0' + (date.getMonth() + 1)).slice(-2);
  const day = ('0' + date.getDate()).slice(-2);
  return `${year}/${month}/${day}`;
}

function getPastDateString(daysAgo) {
  const date = new Date();
  date.setDate(date.getDate() - daysAgo);
  const year = date.getFullYear();
  const month = ('0' + (date.getMonth() + 1)).slice(-2);
  const day = ('0' + date.getDate()).slice(-2);
  return `${year}/${month}/${day}`;
}

function getOrCreateLabel(labelName) {
  let label = GmailApp.getUserLabelByName(labelName);
  if (!label) {
    label = GmailApp.createLabel(labelName);
  }
  return label;
}

// âœ… åˆ¤æ–·æ˜¯å¦ç‚ºç›®æ¨™éƒµä»¶ (Inquiry)
function analyzeEmail(message) {
  try {
    const body = message.getPlainBody().toLowerCase();
    const subject = message.getSubject().toLowerCase();
    const from = message.getFrom().toLowerCase();

    // 1. æª¢æŸ¥æ’é™¤åå–®
    const isExcluded = USER_CONFIG.EXCLUDE_KEYWORDS.some(kw => 
      subject.includes(kw.toLowerCase()) || from.includes(kw.toLowerCase())
    );
    if (isExcluded) return { status: 'EXCLUDED' };

    // 2. æª¢æŸ¥åˆ†æµè¦å‰‡
    for (const [email, keywords] of Object.entries(USER_CONFIG.ROUTING_RULES)) {
      const matchedKeyword = keywords.find(kw => {
        const keywordLower = kw.toLowerCase();
        if (/^[a-z]+$/.test(keywordLower) && keywordLower.length <= 4) {
             const regex = new RegExp(`\\b${keywordLower}\\b`, 'i');
             return regex.test(body) || regex.test(subject);
        }
        return body.includes(keywordLower) || subject.includes(keywordLower);
      });

      if (matchedKeyword) {
        return { status: 'MATCHED', targetEmail: email, keyword: matchedKeyword };
      }
    }

    // 3. æª¢æŸ¥ä¸€èˆ¬è©¢åƒ¹é—œéµå­—
    const generalMatch = USER_CONFIG.GENERAL_KEYWORDS.find(kw => 
      body.includes(kw.toLowerCase()) || subject.includes(kw.toLowerCase())
    );
    
    if (generalMatch) {
      return { status: 'UNKNOWN', keyword: generalMatch };
    }

    return { status: 'IGNORE' };

  } catch (err) {
    Logger.log("[analyzeEmail] Error: " + err);
    return { status: 'ERROR', error: err };
  }
}

// âœ… ä¸»åŸ·è¡Œå‡½å¼ï¼šè½‰å¯„éƒµä»¶
function autoDispatchEmails() {
  const threads = GmailApp.search(`in:inbox after:${getPastDateString(1)} is:unread`);
  const userProperties = PropertiesService.getUserProperties();
  let dispatchLog = JSON.parse(userProperties.getProperty('dispatchLog') || '[]');

  for (const thread of threads) {
    const messages = thread.getMessages();
    const latestMessage = messages[messages.length - 1];
    const subject = latestMessage.getSubject();
    const from = latestMessage.getFrom();
    
    const allRecipients = latestMessage.getTo() + (latestMessage.getCc() || "");
    const isDirectlySent = Object.keys(USER_CONFIG.ROUTING_RULES).some(email => allRecipients.includes(email));
    
    if (isDirectlySent) {
      thread.markRead();
      continue;
    }

    const analysis = analyzeEmail(latestMessage);

    if (analysis.status === 'MATCHED' || analysis.status === 'UNKNOWN') {
      let forwardTo = analysis.status === 'MATCHED' ? analysis.targetEmail : USER_CONFIG.DAILY_REPORT_EMAIL;
      let labelName = analysis.status === 'MATCHED' 
                      ? `${USER_CONFIG.LABEL_PREFIX}${forwardTo.split('@')[0]}` 
                      : USER_CONFIG.UNKNOWN_LABEL;
      
      const color = analysis.status === 'MATCHED' ? '#007bff' : '#ffc107';
      const typeText = analysis.status === 'MATCHED' ? 'Auto-Dispatched' : 'âš ï¸ Unclassified';
      
      const htmlBody = latestMessage.getBody();
      const noticeHtml = `
        <div style="font-family: Arial, sans-serif; border-left: 5px solid ${color}; background-color: #f8f9fa; padding: 15px; margin-bottom: 15px;">
          <strong><span style="color: ${color};">[${typeText}]</span> System Notice:</strong><br>
          This email was routed based on keyword: "<strong>${analysis.keyword}</strong>".<br>
          Original Sender: ${from}
        </div>
        <hr>
        ${htmlBody}
      `;

      try {
        GmailApp.sendEmail(forwardTo, `Fwd: ${subject}`, latestMessage.getPlainBody(), {
          from: USER_CONFIG.DAILY_REPORT_EMAIL,
          name: USER_CONFIG.SENDER_NAME,
          replyTo: from,
          htmlBody: noticeHtml
        });

        thread.addLabel(getOrCreateLabel(labelName));
        thread.markRead();
        Logger.log(`âœ… Forwarded "${subject}" to ${forwardTo}`);

        dispatchLog.push({
          subject, from, forwardTo,
          keyword: analysis.keyword,
          status: analysis.status,
          timestamp: new Date().toISOString()
        });

      } catch (e) {
        Logger.log(`âŒ Failed to forward "${subject}": ${e}`);
      }
    }
  }
  
  if (dispatchLog.length > 500) dispatchLog = dispatchLog.slice(-500);
  userProperties.setProperty('dispatchLog', JSON.stringify(dispatchLog));
}

// âœ… å ±å‘Šå‡½å¼ï¼šæ¯æ—¥æ‘˜è¦
function sendDailyReport() {
  const userProperties = PropertiesService.getUserProperties();
  const logs = JSON.parse(userProperties.getProperty('dispatchLog') || '[]');
  const now = new Date();
  const oneDayAgo = new Date(now.getTime() - 24 * 60 * 60 * 1000);

  const recentLogs = logs.filter(log => new Date(log.timestamp) >= oneDayAgo);
  if (recentLogs.length === 0) return;

  sendReportEmail(
    USER_CONFIG.DAILY_REPORT_EMAIL, 
    `ğŸ“Š Daily Dispatch Report (${formatDate(now)})`, 
    recentLogs, 
    "Here is the summary of emails dispatched in the last 24 hours."
  );
}

// âœ… å ±å‘Šå‡½å¼ï¼šæ¯é€±æ‘˜è¦ (ä¸¦æ¸…ç†èˆŠè³‡æ–™)
function sendWeeklyReport() {
  const userProperties = PropertiesService.getUserProperties();
  const logs = JSON.parse(userProperties.getProperty('dispatchLog') || '[]');
  const now = new Date();
  const sevenDaysAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);

  const weeklyLogs = logs.filter(log => new Date(log.timestamp) >= sevenDaysAgo);
  const dateRange = `${formatDate(sevenDaysAgo)} - ${formatDate(now)}`;

  // 1. ç™¼é€é€±å ±
  if (weeklyLogs.length > 0) {
    sendReportEmail(
      USER_CONFIG.WEEKLY_REPORT_RECIPIENTS,
      `ğŸ“ˆ Weekly Dispatch Report (${dateRange})`,
      weeklyLogs,
      `Summary of all auto-dispatched emails for the past 7 days (${dateRange}).`
    );
  } else {
    MailApp.sendEmail({
        to: USER_CONFIG.WEEKLY_REPORT_RECIPIENTS,
        subject: `ğŸ“ˆ Weekly Dispatch Report (${dateRange}) - No Activity`,
        htmlBody: `<p>No emails were auto-dispatched in the past 7 days.</p>`
    });
  }

  // 2. æ¸…ç†èˆŠè³‡æ–™ (åªä¿ç•™æœ€è¿‘ 7 å¤©çš„ç´€éŒ„)
  userProperties.setProperty('dispatchLog', JSON.stringify(weeklyLogs));
  Logger.log(`System cleanup: Kept ${weeklyLogs.length} logs from the past 7 days.`);
}

// å…§éƒ¨ä½¿ç”¨ï¼šç”¢ç”Ÿä¸¦ç™¼é€ HTML å ±è¡¨
function sendReportEmail(recipient, subject, logs, description) {
  let tableRows = logs.map(log => {
    const time = Utilities.formatDate(new Date(log.timestamp), Session.getScriptTimeZone(), "MM/dd HH:mm");
    const statusIcon = log.status === 'MATCHED' ? 'âœ…' : 'âš ï¸';
    return `<tr>
      <td>${statusIcon}</td>
      <td>${time}</td>
      <td>${log.from.replace(/<.*>/, '').trim()}</td>
      <td>${log.subject}</td>
      <td>${log.keyword}</td>
      <td>${log.forwardTo.split('@')[0]}</td>
    </tr>`;
  }).join('');

  const html = `
    <div style="font-family: Arial, sans-serif; color: #333;">
      <h3 style="color: #007bff;">${subject}</h3>
      <p>${description}</p>
      <table style="width: 100%; border-collapse: collapse; border: 1px solid #ddd; font-size: 14px;">
        <thead style="background-color: #f2f2f2;">
          <tr><th style="padding:8px;border:1px solid #ddd">Status</th><th style="padding:8px;border:1px solid #ddd">Time</th><th style="padding:8px;border:1px solid #ddd">Sender</th><th style="padding:8px;border:1px solid #ddd">Subject</th><th style="padding:8px;border:1px solid #ddd">Keyword</th><th style="padding:8px;border:1px solid #ddd">To</th></tr>
        </thead>
        <tbody>${tableRows}</tbody>
      </table>
    </div>
  `;

  MailApp.sendEmail({ to: recipient, subject: subject, htmlBody: html });
}</code></pre>
        </section>

        <section class="guide-section">
            <h2 style="text-align: center; margin-bottom: 40px;">ğŸš€ åªè¦ 3 åˆ†é˜ï¼Œé–‹å§‹ä½¿ç”¨</h2>
            
            <div class="step">
                <h3>æ­¥é©Ÿ 1ï¼šå»ºç«‹å°ˆæ¡ˆ</h3>
                <p>å‰å¾€ <a href="https://script.google.com/" target="_blank">Google Apps Script</a>ï¼Œé»æ“Šã€Œæ–°å°ˆæ¡ˆã€ã€‚</p>
            </div>

            <div class="step">
                <h3>æ­¥é©Ÿ 2ï¼šè²¼ä¸Šç¨‹å¼ç¢¼</h3>
                <p>æ¸…ç©ºç·¨è¼¯å™¨ä¸­çš„é è¨­ä»£ç¢¼ï¼Œå°‡ä¸Šæ–¹è¤‡è£½çš„ç¨‹å¼ç¢¼å®Œæ•´è²¼ä¸Šã€‚é»æ“Šç£ç¢Ÿç‰‡åœ–ç¤ºå„²å­˜ã€‚</p>
            </div>

            <div class="step">
                <h3>æ­¥é©Ÿ 3ï¼šä¿®æ”¹è¨­å®š (USER_CONFIG)</h3>
                <p>åœ¨ç¨‹å¼ç¢¼æœ€ä¸Šæ–¹çš„ <code>USER_CONFIG</code> å€åŸŸï¼Œä¿®æ”¹æˆæ‚¨çš„ä¿¡ç®±ã€é—œéµå­—èˆ‡åˆ†æµè¦å‰‡ã€‚</p>
            </div>

            <div class="step">
                <h3>æ­¥é©Ÿ 4ï¼šè¨­å®šè‡ªå‹•åŸ·è¡Œ (Triggers)</h3>
                <p>é»æ“Šå·¦å´æ™‚é˜åœ–ç¤º (è§¸ç™¼æ¢ä»¶)ï¼Œæ–°å¢ä»¥ä¸‹ä¸‰å€‹è§¸ç™¼å™¨ï¼š</p>
                <ul style="margin-top: 10px; background: #f1f5f9; padding: 15px 30px; border-radius: 8px;">
                    <li style="margin-bottom: 8px;">å‡½å¼ <strong>autoDispatchEmails</strong> â è¨­ç‚ºã€Œæ™‚é–“é©…å‹•ã€â ã€Œæ¯å°æ™‚ã€åŸ·è¡Œã€‚</li>
                    <li style="margin-bottom: 8px;">å‡½å¼ <strong>sendDailyReport</strong> â è¨­ç‚ºã€Œæ™‚é–“é©…å‹•ã€â ã€Œæ¯å¤©ã€åŸ·è¡Œ (å»ºè­°æ—©ä¸Š)ã€‚</li>
                    <li>å‡½å¼ <strong>sendWeeklyReport</strong> â è¨­ç‚ºã€Œæ™‚é–“é©…å‹•ã€â ã€Œæ¯é€±ã€åŸ·è¡Œ (å»ºè­°é€±ä¸€æ—©ä¸Šï¼Œæ­¤å‡½å¼ä¹Ÿæœƒè‡ªå‹•æ¸…ç†èˆŠç´€éŒ„)ã€‚</li>
                </ul>
            </div>
            
             <p style="text-align: center; margin-top: 30px; color: #666;">å®Œæˆï¼ç¾åœ¨ç³»çµ±æœƒè‡ªå‹•å¹«æ‚¨ç›£æ§ä¸¦åˆ†æµéƒµä»¶äº†ã€‚</p>
        </section>

        <footer>
            <div class="footer-logo">Created by Evelyn YT Liu</div>
            <p>
                <a href="mailto:evelyn.evagor@gmail.com">evelyn.evagor@gmail.com</a>
            </p>
            <p>
                Copyright Â© 2025. All rights reserved.
            </p>
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script>
        function copyCode() {
            const code = document.getElementById('script-code').innerText;
            navigator.clipboard.writeText(code).then(() => {
                const btn = document.querySelector('.copy-btn');
                const originalHtml = btn.innerHTML;
                btn.innerHTML = '<i class="fa-solid fa-check"></i> å·²è¤‡è£½ï¼';
                btn.classList.add('copied');
                
                setTimeout(() => {
                    btn.innerHTML = originalHtml;
                    btn.classList.remove('copied');
                }, 2000);
            }).catch(err => {
                console.error('è¤‡è£½å¤±æ•—:', err);
                alert('è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–è¤‡è£½');
            });
        }
    </script>
</body>
</html>